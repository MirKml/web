{block javascriptsHeader}
<script type="text/javascript" src="/js/netteForms.js"></script>
{/block}

{block content}
<div>
    <article class="hentry" role="article">
        <!-- header for each post -->
        <header>
            <p class="meta">{$article->posted|date:"j. n. Y"}{if $comments} - <a href="#comments">Komentáře ({count($comments)})</a>{/if}
                {foreach $articlesRelation->getCategoriesForArticle($article) as $category}
                    <a class="label" href="{link BlogCategory: $category->titleURL}">{$category->name}</a>
                {/foreach}
            </p>
            <h1 class="entry-title">
                {$article->title}
            </h1>
        </header>

        <div class="entry-content">
            {$article->getHtmlText()|noescape}
        </div>

        <footer>
            <p class="meta">
                <span class="byline author vcard"><img src="/images/writer_male_light_32.png" alt=""> <span class="fn">{$article->authorName}</span></span>
                <!-- can't put the .Date.Format inside the datetime attribute because of double quotes, so it's outside -->
                <time>{$article->posted|date:"j. n. Y"}</time>
                <span class="categories" n:foreach="$articlesRelation->getCategoriesForArticle($article) as $category">
                    <a class="category" href="{link BlogCategory: $category->titleURL}">{$category->name}</a>
                </span>
            </p>

            <!-- For sharing stuff -->
            <!-- <div class="sharing"> </div> -->
            {control previousNextArticle}
        </footer>
    </article>

    <hr>
    <a name="comments"></a>
    <section class="comments">
        {foreach $flashes as $flash}
            <div><i class="fa fa-info fa-2" aria-hidden="true"></i> {$flash->message}</div>
        {/foreach}
        <h2>Komentáře (2) <a href="#addComment">Přidej komentář</a></h2>
        <ol n:inner-foreach="$comments as $comment">
            <li class="comment">
            <article>
                <header>
                    {if $comment->getAuthorWeb()}<a href="{$comment->getAuthorWeb()}">{$comment->name}</a>
                    {else}{$comment->name}{/if} - {$comment->posted|date:"j. n. Y H:i"}
                </header>
                <p>{$comment->getHtmlMessage()|noescape}</p>
            </article>
            </li>

            {if $iterator->isLast() && $commentPreview}
            <li class="comment">
                <article>
                    <header>Náhled nového komentáře</header>
                    <p>{$commentPreview->getHtmlMessage()|noescape}</p>
                </article>
            </li>
            {/if}
        </ol>

        <a name="addComment"></a>
        {form commentForm class => commentForm}
        <fieldset><legend>Přidej komentář</legend>
            {if $control["commentForm"]->hasErrors()}
                <ul class=error n:if="$form->ownErrors" style="color: red; list-style-type: none;">
                    {foreach $control["commentForm"]->getErrors() as $error}
                    <li>
                        <i class="fa fa-exclamation-triangle fa-2" aria-hidden="true"></i> {$error}
                    </li>
                    {/foreach}
                </ul>
            {/if}

            {label name}
            {input name}
            {label email}
            {input email}
            {label www}
            {input www}
            {label message}
            {input message}
            {if $commentPreview}
                Opište kód <img src="{$captchaImageUrl}">
                {input code}
                {input preview}
                {input save}
                {input hash}
            {else}
                {input preview}
            {/if}
        </fieldset>
        {/form}

    </section>
</div>
{/block}
